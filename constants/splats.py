import math
import torch

# Constants for CIFAR-10 dataset
CIFAR_WIDTH = 32
CIFAR_HEIGHT = 32

# Compute focal length
focal = 0.5 * CIFAR_WIDTH / math.tan(0.5 * math.pi / 2.0)

# Camera intrinsic matrix for CIFAR-10
CIFAR10_KS = torch.tensor(
    [
        [focal, 0, CIFAR_WIDTH / 2],
        [0, focal, CIFAR_HEIGHT / 2],
        [0, 0, 1],
    ],
    dtype=torch.float32,  # Ensure the tensor is float32
)

# View matrix for CIFAR-10
CIFAR10_VIEWMATS = torch.tensor(
    [
        [1.0, 0.0, 0.0, 0.0],
        [0.0, 1.0, 0.0, 0.0],
        [0.0, 0.0, 1.0, 8.0],
        [0.0, 0.0, 0.0, 1.0],
    ],
    dtype=torch.float32,  # Ensure the tensor is float32
)

CIFAR10_GRID_RANGES = {
    "means": {
        "min": -1.0,
        "max": 1.0,
        "mean": [3.073364496231079e-08, 0.0, 0.0],
        "std": [0.5956833958625793, 0.5956833958625793, 0.0],
    },
    "quats": {
        "min": -3.7537035942077637,
        "max": 4.574342727661133,
        "mean": [
            0.49086257815361023,
            0.5112597346305847,
            0.49628859758377075,
            0.48551133275032043,
        ],
        "std": [
            0.4739896357059479,
            0.5310168266296387,
            0.5126069188117981,
            0.4742636978626251,
        ],
    },
    "scales": {
        "min": -14.256706237792969,
        "max": 6.657063961029053,
        "mean": [-1.8529794216156006, -1.8229098320007324, -2.4987568855285645],
        "std": [1.4585336446762085, 1.509230375289917, 0.5868567228317261],
    },
    "opacities": {
        "min": -5.512201309204102,
        "max": 7.002721309661865,
        "mean": -3.367799997329712,
        "std": 1.417393684387207,
    },
    "colors": {
        "min": -15.537788391113281,
        "max": 17.288856506347656,
        "mean": [
            [0.6861101388931274, 0.6411524415016174, 0.6533592343330383],
            [-0.034583691507577896, -0.02748388983309269, -0.015395736321806908],
            [0.7585484981536865, 0.7298418879508972, 0.6634648442268372],
            [-0.01002707239240408, -0.020831072703003883, -0.022523043677210808],
        ],
        "std": [
            [2.45888614654541, 2.381861686706543, 2.402751922607422],
            [1.9165422916412354, 1.8433748483657837, 1.8344460725784302],
            [2.15236496925354, 2.076561689376831, 2.0886363983154297],
            [1.91488516330719, 1.835733413696289, 1.827427864074707],
        ],
    },
}
